{"expires":1743604763.724,"value":{"highlighted":"<!-- Syntax highlighted by torchlight.dev --><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 1</span><span style=\"color: #D73A49;\">class</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">MinimalEnv</span><span style=\"color: #24292E;\"> : </span><span style=\"color: #D73A49;\">public</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">BaseEnv</span><span style=\"color: #24292E;\"> {</span><span style=\"color: #6A737D;\"> // 继承自 BaseEnv</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 2</span><span style=\"color: #D73A49;\">public:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 3</span><span style=\"color: #24292E;\">    </span><span style=\"color: #6F42C1;\">MinimalEnv</span><span style=\"color: #24292E;\">() : </span><span style=\"color: #6F42C1;\">cpp_state</span><span style=\"color: #24292E;\">(</span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">) {}</span><span style=\"color: #6A737D;\"> // 初始化 cpp_state 为 0</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 4</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 5</span><span style=\"color: #24292E;\">    </span><span style=\"color: #6F42C1;\">~MinimalEnv</span><span style=\"color: #24292E;\">() {}</span><span style=\"color: #6A737D;\"> // 析构函数</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 6</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 7</span><span style=\"color: #24292E;\">    </span><span style=\"color: #6F42C1;\">py</span><span style=\"color: #24292E;\">::</span><span style=\"color: #6F42C1;\">object</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">reset</span><span style=\"color: #24292E;\">() override</span><span style=\"color: #6A737D;\"> // 重写 BaseEnv 中定义的 reset 方法</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 8</span><span style=\"color: #24292E;\">    {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 9</span><span style=\"color: #24292E;\">        </span><span style=\"color: #6F42C1;\">py</span><span style=\"color: #24292E;\">::dict result;</span><span style=\"color: #6A737D;\"> // 创建一个字典来存储要返回的结果</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">10</span><span style=\"color: #24292E;\">        cpp_state </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">;</span><span style=\"color: #6A737D;\"> // 将 cpp_state 重置为 0</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">11</span><span style=\"color: #24292E;\">        result[</span><span style=\"color: #032F62;\">&quot;cpp_state&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> cpp_state;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">12</span><span style=\"color: #24292E;\">        result[</span><span style=\"color: #032F62;\">&quot;info&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #032F62;\">&quot;&quot;</span><span style=\"color: #24292E;\">;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">13</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">return</span><span style=\"color: #24292E;\"> result;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">14</span><span style=\"color: #24292E;\">    }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">15</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">16</span><span style=\"color: #24292E;\">    </span><span style=\"color: #6F42C1;\">py</span><span style=\"color: #24292E;\">::</span><span style=\"color: #6F42C1;\">object</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">step</span><span style=\"color: #24292E;\">(</span><span style=\"color: #D73A49;\">const</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">py</span><span style=\"color: #24292E;\">::</span><span style=\"color: #6F42C1;\">object</span><span style=\"color: #D73A49;\">&amp;</span><span style=\"color: #24292E;\"> </span><span style=\"color: #E36209;\">action</span><span style=\"color: #24292E;\">) override</span><span style=\"color: #6A737D;\"> // step 方法从 Python 端接收动作</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">17</span><span style=\"color: #24292E;\">    {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">18</span><span style=\"color: #6A737D;\">        // 在每一步中，环境将 action[&quot;value&quot;] 的值加到其 cpp_state 上</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">19</span><span style=\"color: #24292E;\">        </span><span style=\"color: #6F42C1;\">py</span><span style=\"color: #24292E;\">::dict result;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">20</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> (action.</span><span style=\"color: #6F42C1;\">contains</span><span style=\"color: #24292E;\">(</span><span style=\"color: #032F62;\">&quot;value&quot;</span><span style=\"color: #24292E;\">))</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">21</span><span style=\"color: #24292E;\">        {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">22</span><span style=\"color: #24292E;\">            </span><span style=\"color: #D73A49;\">try</span><span style=\"color: #24292E;\"> {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">23</span><span style=\"color: #24292E;\">                </span><span style=\"color: #D73A49;\">int</span><span style=\"color: #24292E;\"> value </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> action[</span><span style=\"color: #032F62;\">&quot;value&quot;</span><span style=\"color: #24292E;\">].cast</span><span style=\"color: #D73A49;\">&lt;int&gt;</span><span style=\"color: #24292E;\">();</span><span style=\"color: #6A737D;\"> // 将 action[&quot;value&quot;] 的值转换为整数</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">24</span><span style=\"color: #24292E;\">                cpp_state </span><span style=\"color: #D73A49;\">+=</span><span style=\"color: #24292E;\"> value;</span><span style=\"color: #6A737D;\"> // 将该值加到 cpp_state 上</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">25</span><span style=\"color: #24292E;\">            } </span><span style=\"color: #D73A49;\">catch</span><span style=\"color: #24292E;\"> (</span><span style=\"color: #D73A49;\">const</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">std</span><span style=\"color: #24292E;\">::exception </span><span style=\"color: #D73A49;\">&amp;</span><span style=\"color: #24292E;\">e) {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">26</span><span style=\"color: #24292E;\">                result[</span><span style=\"color: #032F62;\">&quot;info&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">std</span><span style=\"color: #24292E;\">::</span><span style=\"color: #6F42C1;\">string</span><span style=\"color: #24292E;\">(</span><span style=\"color: #032F62;\">&quot;failed to convert value to int: &quot;</span><span style=\"color: #24292E;\">) </span><span style=\"color: #D73A49;\">+</span><span style=\"color: #24292E;\"> e.</span><span style=\"color: #6F42C1;\">what</span><span style=\"color: #24292E;\">();</span><span style=\"color: #6A737D;\"> // 如果该值不是整数，在结果中添加错误信息</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">27</span><span style=\"color: #24292E;\">            }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">28</span><span style=\"color: #24292E;\">        }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">29</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">else</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">30</span><span style=\"color: #24292E;\">        {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">31</span><span style=\"color: #24292E;\">            result[</span><span style=\"color: #032F62;\">&quot;info&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #032F62;\">&quot;error: action must contain &#39;value&#39;&quot;</span><span style=\"color: #24292E;\">;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">32</span><span style=\"color: #24292E;\">        }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">33</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">34</span><span style=\"color: #24292E;\">        result[</span><span style=\"color: #032F62;\">&quot;cpp_state&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> cpp_state;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">35</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> (</span><span style=\"color: #D73A49;\">!</span><span style=\"color: #24292E;\">result.</span><span style=\"color: #6F42C1;\">contains</span><span style=\"color: #24292E;\">(</span><span style=\"color: #032F62;\">&quot;info&quot;</span><span style=\"color: #24292E;\">))</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">36</span><span style=\"color: #24292E;\">        {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">37</span><span style=\"color: #6A737D;\">            // 如果结果中没有 info 键，添加一个空字符串，以避免 key error</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">38</span><span style=\"color: #24292E;\">            result[</span><span style=\"color: #032F62;\">&quot;info&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #032F62;\">&quot;&quot;</span><span style=\"color: #24292E;\">;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">39</span><span style=\"color: #24292E;\">        }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">40</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">return</span><span style=\"color: #24292E;\"> result;</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">41</span><span style=\"color: #24292E;\">    }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">42</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">43</span><span style=\"color: #D73A49;\">private:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">44</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">int</span><span style=\"color: #24292E;\"> cpp_state </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">;</span><span style=\"color: #6A737D;\"> // 私有成员变量，用于存储环境的状态</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">45</span><span style=\"color: #24292E;\">};</span></div>","classes":"torchlight","styles":"background-color: #fff; --theme-selection-background: #e2e5e9;"}}
