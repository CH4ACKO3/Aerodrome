{"expires":1743603898.02,"value":{"highlighted":"<!-- Syntax highlighted by torchlight.dev --><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 1</span><span style=\"color: #C792EA;\">def</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">layer</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> std</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\">np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">sqrt</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">2</span><span style=\"color: #89DDFF;\">),</span><span style=\"color: #A6ACCD;\"> bias_const</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 2</span><span style=\"color: #A6ACCD;\">    torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">init</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">orthogonal_</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">layer</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">weight</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> std</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 3</span><span style=\"color: #A6ACCD;\">    torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">init</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">constant_</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">layer</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">bias</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> bias_const</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 4</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #89DDFF;\">return</span><span style=\"color: #A6ACCD;\"> layer</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 5</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 6</span><span style=\"color: #C792EA;\">class</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #FFCB6B;\">Agent</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #FFCB6B;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #FFCB6B;\">Module</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 7</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #C792EA;\">def</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">__init__</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">self</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 8</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #FFCB6B;\">super</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">__init__</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 9</span><span style=\"color: #A6ACCD;\">        self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">critic</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Sequential</span><span style=\"color: #89DDFF;\">(</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">10</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">3</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">)),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">11</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ReLU</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">12</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">)),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">13</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ReLU</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">14</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">)),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">15</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ReLU</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">16</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">),</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">std</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">17</span><span style=\"color: #82AAFF;\">        </span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">18</span><span style=\"color: #A6ACCD;\">        self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">actor_mean</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Sequential</span><span style=\"color: #89DDFF;\">(</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">19</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">3</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">128</span><span style=\"color: #89DDFF;\">)),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">20</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ReLU</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">21</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">128</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">128</span><span style=\"color: #89DDFF;\">)),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">22</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ReLU</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">23</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">128</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">128</span><span style=\"color: #89DDFF;\">)),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">24</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ReLU</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">25</span><span style=\"color: #82AAFF;\">            layer_init</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Linear</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">128</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">),</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">std</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.01</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">26</span><span style=\"color: #82AAFF;\">            nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tanh</span><span style=\"color: #89DDFF;\">(),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">27</span><span style=\"color: #82AAFF;\">        </span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">28</span><span style=\"color: #A6ACCD;\">        self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">actor_logstd</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Parameter</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">))</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">29</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">30</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #C792EA;\">def</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">get_value</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">self</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> x</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">31</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">return</span><span style=\"color: #A6ACCD;\"> self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">critic</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">x</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">32</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">33</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #C792EA;\">def</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">get_action_and_value</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">self</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> x</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> action</span><span style=\"color: #89DDFF;\">=None,</span><span style=\"color: #A6ACCD;\"> evaluate</span><span style=\"color: #89DDFF;\">=False):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">34</span><span style=\"color: #A6ACCD;\">        action_mean </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">actor_mean</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">x</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">35</span><span style=\"color: #A6ACCD;\">        action_logstd </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">actor_logstd</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">expand_as</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">action_mean</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">36</span><span style=\"color: #A6ACCD;\">        action_std </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">exp</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">action_logstd</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">37</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> evaluate</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">38</span><span style=\"color: #A6ACCD;\">            probs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">Normal</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">action_mean</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> action_std</span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #F78C6C;\">1e-6</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">39</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">else</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">40</span><span style=\"color: #A6ACCD;\">            probs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">Normal</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">action_mean</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> action_std</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">41</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> action </span><span style=\"color: #89DDFF;\">is</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">None:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">42</span><span style=\"color: #A6ACCD;\">            action </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> probs</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">sample</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">43</span><span style=\"color: #A6ACCD;\">        action </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">clamp</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">action</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">44</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">return</span><span style=\"color: #A6ACCD;\"> action</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> probs</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">log_prob</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">action</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">sum</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">),</span><span style=\"color: #A6ACCD;\"> probs</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">entropy</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">sum</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">),</span><span style=\"color: #A6ACCD;\"> self</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">critic</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">x</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">45</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">46</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">47</span><span style=\"color: #C792EA;\">def</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">linear_schedule</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">start_e</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> end_e</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> duration</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> t</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">48</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #89DDFF;\">return</span><span style=\"color: #A6ACCD;\"> start_e </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">end_e </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> start_e</span><span style=\"color: #89DDFF;\">)</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">min</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">t </span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #82AAFF;\"> duration</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div>","classes":"torchlight","styles":"background-color: #292D3E; --theme-selection-background: #00000080;"}}
