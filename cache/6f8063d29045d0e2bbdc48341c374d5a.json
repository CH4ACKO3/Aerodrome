{"expires":1743603898.021,"value":{"highlighted":"<!-- Syntax highlighted by torchlight.dev --><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  1</span><span style=\"color: #C792EA;\">def</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">main</span><span style=\"color: #89DDFF;\">():</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  2</span><span style=\"color: #A6ACCD;\">    parser </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> argparse</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">ArgumentParser</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  3</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--seed</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  4</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">random seed of the experiment</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  5</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--num_steps</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">1024</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  6</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the number of steps to run per policy rollout</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  7</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--total_timesteps</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">300_000</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  8</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the number of iterations</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  9</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--batch_size</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">256</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 10</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the batch size of sample from the replay memory</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 11</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--gamma</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.99</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 12</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">discount factor</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 13</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--gae_lambda</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.95</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 14</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">lambda for the general advantage estimation</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 15</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--num_minibatches</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 16</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the number of mini-batches</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 17</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--update_epochs</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">20</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 18</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the K epochs to update the policy</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 19</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--norm_adv</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">bool</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=True,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 20</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Toggles advantages normalization</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 21</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--clip_coef</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.2</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 22</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the surrogate clipping coefficient</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 23</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--clip_vloss</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">bool</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=True,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 24</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Toggles whether or not to use a clipped loss for the value function</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 25</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--ent_coef</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.2</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 26</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">coefficient of the entropy</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 27</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--vf_coef</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">2</span><span style=\"color: #89DDFF;\">.,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 28</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">coefficient of the value function</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 29</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--max_grad_norm</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">0.5</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 30</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the maximum norm for the gradient clipping</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 31</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--target_kl</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=None,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 32</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">the target KL divergence threshold</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 33</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 34</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--learning_rate</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">float</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">1e-4</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 35</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">learning rate</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 36</span><span style=\"color: #A6ACCD;\">    parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_argument</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">--device</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">type</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #FFCB6B;\">str</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">default</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">cuda</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #82AAFF;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">cuda</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">is_available</span><span style=\"color: #89DDFF;\">()</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">else</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">cpu</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 37</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #A6ACCD;\">help</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Device to run the experiment on</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 38</span><span style=\"color: #A6ACCD;\">    args </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> parser</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">parse_args</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 39</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 40</span><span style=\"color: #A6ACCD;\">    args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">batch_size</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 41</span><span style=\"color: #A6ACCD;\">    args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">minibatch_size</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #FFCB6B;\">int</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">batch_size</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">//</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_minibatches</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 42</span><span style=\"color: #A6ACCD;\">    args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">total_timesteps</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">//</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">batch_size</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 43</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 44</span><span style=\"color: #A6ACCD;\">    random</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">seed</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">seed</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 45</span><span style=\"color: #A6ACCD;\">    np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">random</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">seed</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">seed</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 46</span><span style=\"color: #A6ACCD;\">    torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">manual_seed</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">seed</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 47</span><span style=\"color: #A6ACCD;\">    torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">backends</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">cudnn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">deterministic</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">True</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 48</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 49</span><span style=\"color: #A6ACCD;\">    device </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 50</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #82AAFF;\">print</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #C792EA;\">f</span><span style=\"color: #C3E88D;\">&quot;Using device: </span><span style=\"color: #82AAFF;\">{device}</span><span style=\"color: #C3E88D;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 51</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 52</span><span style=\"color: #A6ACCD;\">    env </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> aerodrome</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">make</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">wingedcone-v0</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 53</span><span style=\"color: #A6ACCD;\">    object_dict </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">{</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 54</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">name</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">test</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 55</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">integrator</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">rk45</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 56</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">S</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">3603.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 57</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">c</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">80.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 58</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">m</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">9375.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 59</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 60</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">pos</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">33528.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">],</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 61</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">vel</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #F78C6C;\">4590.29</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">],</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 62</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">ang_vel</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">],</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 63</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">J</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">7</span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #F78C6C;\">10</span><span style=\"color: #89DDFF;\">**</span><span style=\"color: #F78C6C;\">6</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">7</span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #F78C6C;\">10</span><span style=\"color: #89DDFF;\">**</span><span style=\"color: #F78C6C;\">6</span><span style=\"color: #89DDFF;\">],</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 64</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">theta</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.00</span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #F78C6C;\">180</span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\">pi</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 65</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">phi</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 66</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">gamma</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\">   </span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 67</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">theta_v</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 68</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">phi_v</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 69</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">gamma_v</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 70</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">alpha</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.00</span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #F78C6C;\">180</span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\">pi</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 71</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">beta</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 72</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 73</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Kiz</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.2597</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 74</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Kwz</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1.6</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 75</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Kaz</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">13</span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #F78C6C;\">2</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 76</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Kpz</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.14</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 77</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Kp_V</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">5.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 78</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Ki_V</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 79</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Kd_V</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.3</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 80</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #89DDFF;\">}</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 81</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 82</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">WingedCone2D_RL</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">object_dict</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 83</span><span style=\"color: #A6ACCD;\">    env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_object</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 84</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 85</span><span style=\"color: #A6ACCD;\">    agent </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">Agent</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 86</span><span style=\"color: #A6ACCD;\">    optimizer </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> optim</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Adam</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">parameters</span><span style=\"color: #89DDFF;\">(),</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">lr</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">learning_rate</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">eps</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #F78C6C;\">1e-5</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 87</span><span style=\"color: #A6ACCD;\">    cos_annealing_scheduler </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">CosineAnnealingLR</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">optimizer</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">T_max</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">eta_min</span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">learning_rate</span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #F78C6C;\">10</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 88</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 89</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #676E95;\"># Storage setup</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 90</span><span style=\"color: #A6ACCD;\">    obs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">3</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 91</span><span style=\"color: #A6ACCD;\">    actions </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 92</span><span style=\"color: #A6ACCD;\">    logprobs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 93</span><span style=\"color: #A6ACCD;\">    rewards </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 94</span><span style=\"color: #A6ACCD;\">    dones </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 95</span><span style=\"color: #A6ACCD;\">    values </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 96</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 97</span><span style=\"color: #A6ACCD;\">    global_step </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 98</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 99</span><span style=\"color: #A6ACCD;\">    records </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">{</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">100</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">reward</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">101</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">learning_rate</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">102</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">value_loss</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">103</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">policy_loss</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">104</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">entropy</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">),</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">105</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #89DDFF;\">}</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">106</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">107</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #A6ACCD;\"> iteration </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">tqdm</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">108</span><span style=\"color: #A6ACCD;\">        env </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> aerodrome</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">make</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">wingedcone-v0</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">109</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">WingedCone2D_RL</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">object_dict</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">110</span><span style=\"color: #A6ACCD;\">        env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_object</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">111</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">112</span><span style=\"color: #A6ACCD;\">        next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> info </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reset</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">113</span><span style=\"color: #A6ACCD;\">        next_obs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">114</span><span style=\"color: #A6ACCD;\">        first_rollout </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">True</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">115</span><span style=\"color: #A6ACCD;\">        rollout_return </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.0</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">116</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #A6ACCD;\"> step </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">117</span><span style=\"color: #A6ACCD;\">            global_step </span><span style=\"color: #89DDFF;\">+=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">118</span><span style=\"color: #A6ACCD;\">            obs</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> next_obs</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">119</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">120</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #676E95;\"># ALGO LOGIC: action logic</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">121</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">with</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">no_grad</span><span style=\"color: #89DDFF;\">():</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">122</span><span style=\"color: #A6ACCD;\">                action</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> logprob</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> _</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> value </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">get_action_and_value</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">123</span><span style=\"color: #A6ACCD;\">                values</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> value</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">flatten</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">124</span><span style=\"color: #A6ACCD;\">            actions</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> action</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">125</span><span style=\"color: #A6ACCD;\">            logprobs</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> logprob</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">126</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">127</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #676E95;\"># TRY NOT TO MODIFY: execute the game and log data.</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">128</span><span style=\"color: #A6ACCD;\">            step_action </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">{</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">129</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">test</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">{</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Nyc</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Vc</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #F78C6C;\">4590.29</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">nn_control</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\">action</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()},</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">130</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">}</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">131</span><span style=\"color: #A6ACCD;\">            next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> reward</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> terminations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> truncations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> infos </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">step</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">step_action</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">132</span><span style=\"color: #A6ACCD;\">            next_done </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">logical_or</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">terminations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> truncations</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">133</span><span style=\"color: #A6ACCD;\">            rewards</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">reward</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">view</span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">134</span><span style=\"color: #A6ACCD;\">            next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> next_done </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">),</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_done</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">135</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">136</span><span style=\"color: #A6ACCD;\">            dones</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> next_done</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">137</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">138</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> first_rollout</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">139</span><span style=\"color: #A6ACCD;\">                rollout_return </span><span style=\"color: #89DDFF;\">+=</span><span style=\"color: #A6ACCD;\"> reward</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">140</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> next_done </span><span style=\"color: #89DDFF;\">or</span><span style=\"color: #A6ACCD;\"> step </span><span style=\"color: #89DDFF;\">==</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">141</span><span style=\"color: #A6ACCD;\">                    first_rollout </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">False</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">142</span><span style=\"color: #A6ACCD;\">                    rewards</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">step</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> rollout_return</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">143</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">144</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> next_done</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">145</span><span style=\"color: #A6ACCD;\">                env </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> aerodrome</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">make</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">wingedcone-v0</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">146</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">WingedCone2D_RL</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">object_dict</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">147</span><span style=\"color: #A6ACCD;\">                env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_object</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">148</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">149</span><span style=\"color: #A6ACCD;\">                next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> info </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reset</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">150</span><span style=\"color: #A6ACCD;\">                next_obs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">151</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">152</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #676E95;\"># bootstrap value if not done</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">153</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">with</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">no_grad</span><span style=\"color: #89DDFF;\">():</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">154</span><span style=\"color: #A6ACCD;\">            next_value </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">get_value</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">155</span><span style=\"color: #A6ACCD;\">            advantages </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zeros_like</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">rewards</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">156</span><span style=\"color: #A6ACCD;\">            lastgaelam </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">157</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #A6ACCD;\"> t </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">reversed</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #89DDFF;\">)):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">158</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> t </span><span style=\"color: #89DDFF;\">==</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_steps</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">159</span><span style=\"color: #A6ACCD;\">                    nextnonterminal </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> next_done</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">160</span><span style=\"color: #A6ACCD;\">                    nextvalues </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> next_value</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">161</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">else</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">162</span><span style=\"color: #A6ACCD;\">                    nextnonterminal </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> dones</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">t</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">163</span><span style=\"color: #A6ACCD;\">                    nextvalues </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> values</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">t </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">164</span><span style=\"color: #A6ACCD;\">                delta </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> rewards</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">t</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">gamma</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> nextvalues </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> nextnonterminal </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> values</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">t</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">165</span><span style=\"color: #A6ACCD;\">                advantages</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">t</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> lastgaelam </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> delta </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">gamma</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">gae_lambda</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> nextnonterminal </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> lastgaelam</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">166</span><span style=\"color: #A6ACCD;\">            returns </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> advantages </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> values</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">167</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">168</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #676E95;\"># flatten the batch</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">169</span><span style=\"color: #A6ACCD;\">        b_obs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> obs</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">3</span><span style=\"color: #89DDFF;\">))</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">170</span><span style=\"color: #A6ACCD;\">        b_logprobs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> logprobs</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">171</span><span style=\"color: #A6ACCD;\">        b_actions </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> actions</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">))</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">172</span><span style=\"color: #A6ACCD;\">        b_advantages </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> advantages</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">173</span><span style=\"color: #A6ACCD;\">        b_returns </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> returns</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">174</span><span style=\"color: #A6ACCD;\">        b_values </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> values</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">175</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">176</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #676E95;\"># Optimizing the policy and value network</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">177</span><span style=\"color: #A6ACCD;\">        b_inds </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">arange</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">batch_size</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">178</span><span style=\"color: #A6ACCD;\">        clipfracs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">179</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #A6ACCD;\"> epoch </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">update_epochs</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">180</span><span style=\"color: #A6ACCD;\">            np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">random</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">shuffle</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">b_inds</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">181</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #A6ACCD;\"> start </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">batch_size</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">minibatch_size</span><span style=\"color: #89DDFF;\">):</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">182</span><span style=\"color: #A6ACCD;\">                end </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> start </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">minibatch_size</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">183</span><span style=\"color: #A6ACCD;\">                mb_inds </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> b_inds</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">start</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\">end</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">184</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">185</span><span style=\"color: #A6ACCD;\">                _</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> newlogprob</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> entropy</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> newvalue </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">get_action_and_value</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">b_obs</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #82AAFF;\">mb_inds</span><span style=\"color: #89DDFF;\">],</span><span style=\"color: #82AAFF;\"> b_actions</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #82AAFF;\">mb_inds</span><span style=\"color: #89DDFF;\">])</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">186</span><span style=\"color: #A6ACCD;\">                logratio </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> newlogprob </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> b_logprobs</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">mb_inds</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">187</span><span style=\"color: #A6ACCD;\">                ratio </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> logratio</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">exp</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">188</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">189</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">with</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">no_grad</span><span style=\"color: #89DDFF;\">():</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">190</span><span style=\"color: #A6ACCD;\">                    </span><span style=\"color: #676E95;\"># calculate approx_kl http://joschu.net/blog/kl-approx.html</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">191</span><span style=\"color: #A6ACCD;\">                    old_approx_kl </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #A6ACCD;\">logratio</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">192</span><span style=\"color: #A6ACCD;\">                    approx_kl </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #A6ACCD;\">ratio </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> logratio</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">193</span><span style=\"color: #A6ACCD;\">                    clipfracs </span><span style=\"color: #89DDFF;\">+=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[((</span><span style=\"color: #A6ACCD;\">ratio </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">abs</span><span style=\"color: #89DDFF;\">()</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&gt;</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">clip_coef</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">float</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">194</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">195</span><span style=\"color: #A6ACCD;\">                mb_advantages </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> b_advantages</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">mb_inds</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">196</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">norm_adv</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">197</span><span style=\"color: #A6ACCD;\">                    mb_advantages </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">mb_advantages </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> mb_advantages</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">())</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">mb_advantages</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">std</span><span style=\"color: #89DDFF;\">()</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1e-8</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">198</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">199</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #676E95;\"># Policy loss</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">200</span><span style=\"color: #A6ACCD;\">                pg_loss1 </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\">mb_advantages </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> ratio</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">201</span><span style=\"color: #A6ACCD;\">                pg_loss2 </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\">mb_advantages </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">clamp</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">ratio</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">clip_coef</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">clip_coef</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">202</span><span style=\"color: #A6ACCD;\">                pg_loss </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">max</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">pg_loss1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> pg_loss2</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">203</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">204</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #676E95;\"># Value loss</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">205</span><span style=\"color: #A6ACCD;\">                newvalue </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> newvalue</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">view</span><span style=\"color: #89DDFF;\">(-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">206</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">clip_vloss</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">207</span><span style=\"color: #A6ACCD;\">                    v_loss_unclipped </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">newvalue </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> b_returns</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">mb_inds</span><span style=\"color: #89DDFF;\">])</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">**</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">2</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">208</span><span style=\"color: #A6ACCD;\">                    v_clipped </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> b_values</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">mb_inds</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">clamp</span><span style=\"color: #89DDFF;\">(</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">209</span><span style=\"color: #82AAFF;\">                        newvalue </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #82AAFF;\"> b_values</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #82AAFF;\">mb_inds</span><span style=\"color: #89DDFF;\">],</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">210</span><span style=\"color: #82AAFF;\">                        </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #82AAFF;\">args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">clip_coef</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">211</span><span style=\"color: #82AAFF;\">                        args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">clip_coef</span><span style=\"color: #89DDFF;\">,</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">212</span><span style=\"color: #82AAFF;\">                    </span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">213</span><span style=\"color: #A6ACCD;\">                    v_loss_clipped </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #A6ACCD;\">v_clipped </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> b_returns</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">mb_inds</span><span style=\"color: #89DDFF;\">])</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">**</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">2</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">214</span><span style=\"color: #A6ACCD;\">                    v_loss_max </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">max</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">v_loss_unclipped</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> v_loss_clipped</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">215</span><span style=\"color: #A6ACCD;\">                    v_loss </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.5</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> v_loss_max</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">216</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">else</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">217</span><span style=\"color: #A6ACCD;\">                    v_loss </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0.5</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #A6ACCD;\">newvalue </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> b_returns</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #A6ACCD;\">mb_inds</span><span style=\"color: #89DDFF;\">])</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">**</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">2</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">218</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">219</span><span style=\"color: #A6ACCD;\">                entropy_loss </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> entropy</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">mean</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">220</span><span style=\"color: #A6ACCD;\">                loss </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> pg_loss </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">ent_coef</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> entropy_loss </span><span style=\"color: #89DDFF;\">+</span><span style=\"color: #A6ACCD;\"> v_loss </span><span style=\"color: #89DDFF;\">*</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">vf_coef</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">221</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">222</span><span style=\"color: #A6ACCD;\">                optimizer</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">zero_grad</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">223</span><span style=\"color: #A6ACCD;\">                loss</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">backward</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">224</span><span style=\"color: #A6ACCD;\">                nn</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">utils</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">clip_grad_norm_</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">parameters</span><span style=\"color: #89DDFF;\">(),</span><span style=\"color: #82AAFF;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">max_grad_norm</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">225</span><span style=\"color: #A6ACCD;\">                optimizer</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">step</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">226</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">227</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">target_kl</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">is</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">not</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">None</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">and</span><span style=\"color: #A6ACCD;\"> approx_kl </span><span style=\"color: #89DDFF;\">&gt;</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">target_kl</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">228</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">break</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">229</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">230</span><span style=\"color: #A6ACCD;\">        y_pred</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> y_true </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> b_values</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">cpu</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">numpy</span><span style=\"color: #89DDFF;\">(),</span><span style=\"color: #A6ACCD;\"> b_returns</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">cpu</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">numpy</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">231</span><span style=\"color: #A6ACCD;\">        var_y </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">var</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">y_true</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">232</span><span style=\"color: #A6ACCD;\">        explained_var </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">nan</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> var_y </span><span style=\"color: #89DDFF;\">==</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">else</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">var</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">y_true </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #82AAFF;\"> y_pred</span><span style=\"color: #89DDFF;\">)</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">/</span><span style=\"color: #A6ACCD;\"> var_y</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">233</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">234</span><span style=\"color: #A6ACCD;\">        records</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">reward</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #A6ACCD;\">iteration </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> rewards</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">sum</span><span style=\"color: #89DDFF;\">().</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">235</span><span style=\"color: #A6ACCD;\">        records</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">learning_rate</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #A6ACCD;\">iteration </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> optimizer</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">param_groups</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #F78C6C;\">0</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">lr</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">236</span><span style=\"color: #A6ACCD;\">        records</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">value_loss</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #A6ACCD;\">iteration </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> v_loss</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">237</span><span style=\"color: #A6ACCD;\">        records</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">policy_loss</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #A6ACCD;\">iteration </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> pg_loss</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">238</span><span style=\"color: #A6ACCD;\">        records</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">entropy</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #A6ACCD;\">iteration </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> entropy_loss</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">239</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">240</span><span style=\"color: #A6ACCD;\">        cos_annealing_scheduler</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">step</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">241</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">242</span><span style=\"color: #A6ACCD;\">        </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> iteration </span><span style=\"color: #89DDFF;\">==</span><span style=\"color: #A6ACCD;\"> args</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #F07178;\">num_iterations</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">243</span><span style=\"color: #A6ACCD;\">            states </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">244</span><span style=\"color: #A6ACCD;\">            rewards </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">[]</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">245</span><span style=\"color: #A6ACCD;\">            env </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> aerodrome</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">make</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">wingedcone-v0</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">246</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #82AAFF;\">WingedCone2D_RL</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">object_dict</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">247</span><span style=\"color: #A6ACCD;\">            env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">add_object</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #FFCB6B;\">object</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">248</span><span style=\"color: #A6ACCD;\">            next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> info </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">reset</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">249</span><span style=\"color: #A6ACCD;\">            next_obs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">250</span><span style=\"color: #A6ACCD;\">            step </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">0</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">251</span><span style=\"color: #A6ACCD;\">            </span><span style=\"color: #89DDFF;\">while</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">True:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">252</span><span style=\"color: #A6ACCD;\">                step </span><span style=\"color: #89DDFF;\">+=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">253</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #676E95;\"># ALGO LOGIC: action logic</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">254</span><span style=\"color: #A6ACCD;\">                states</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">append</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">get_state</span><span style=\"color: #89DDFF;\">())</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">255</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">with</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">no_grad</span><span style=\"color: #89DDFF;\">():</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">256</span><span style=\"color: #A6ACCD;\">                    action</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> logprob</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> _</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> value </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">get_action_and_value</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #A6ACCD;\">evaluate</span><span style=\"color: #89DDFF;\">=True)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">257</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">258</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #676E95;\"># TRY NOT TO MODIFY: execute the game and log data.</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">259</span><span style=\"color: #A6ACCD;\">                step_action </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">{</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">260</span><span style=\"color: #A6ACCD;\">                    </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">test</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">{</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Nyc</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #F78C6C;\">1.0</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Vc</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #F78C6C;\">4590.29</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">nn_control</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span><span style=\"color: #A6ACCD;\">action</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">item</span><span style=\"color: #89DDFF;\">()},</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">261</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">}</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">262</span><span style=\"color: #A6ACCD;\">                next_obs</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> reward</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> terminations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> truncations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> infos </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> env</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">step</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">step_action</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">263</span><span style=\"color: #A6ACCD;\">                next_done </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">logical_or</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">terminations</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> truncations</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">264</span><span style=\"color: #A6ACCD;\">                next_obs </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">Tensor</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">next_obs</span><span style=\"color: #89DDFF;\">).</span><span style=\"color: #82AAFF;\">reshape</span><span style=\"color: #89DDFF;\">((</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">-</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)).</span><span style=\"color: #82AAFF;\">to</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">device</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">265</span><span style=\"color: #A6ACCD;\">                rewards</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">append</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">reward</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">266</span><span style=\"color: #A6ACCD;\">                </span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> next_done </span><span style=\"color: #89DDFF;\">or</span><span style=\"color: #A6ACCD;\"> step </span><span style=\"color: #89DDFF;\">&gt;=</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #F78C6C;\">1000</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">267</span><span style=\"color: #A6ACCD;\">                    </span><span style=\"color: #89DDFF;\">break</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">268</span><span style=\"color: #A6ACCD;\">            fig</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> ax </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> plt</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">subplots</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">269</span><span style=\"color: #A6ACCD;\">            x </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">array</span><span style=\"color: #89DDFF;\">([</span><span style=\"color: #82AAFF;\">states</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #82AAFF;\">i</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">pos</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #F78C6C;\">0</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #82AAFF;\"> i </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #82AAFF;\"> range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">len</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">states</span><span style=\"color: #89DDFF;\">))])</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">270</span><span style=\"color: #A6ACCD;\">            y </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> np</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">array</span><span style=\"color: #89DDFF;\">([</span><span style=\"color: #82AAFF;\">states</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #82AAFF;\">i</span><span style=\"color: #89DDFF;\">][</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Ny</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">]</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">for</span><span style=\"color: #82AAFF;\"> i </span><span style=\"color: #89DDFF;\">in</span><span style=\"color: #82AAFF;\"> range</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">len</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">states</span><span style=\"color: #89DDFF;\">))])</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">271</span><span style=\"color: #A6ACCD;\">            ax</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">plot</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">x</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> y</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">272</span><span style=\"color: #A6ACCD;\">            ax</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">plot</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">x</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> rewards</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">273</span><span style=\"color: #A6ACCD;\">            plt</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">show</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">274</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">275</span><span style=\"color: #A6ACCD;\">    fig</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #A6ACCD;\"> ax </span><span style=\"color: #89DDFF;\">=</span><span style=\"color: #A6ACCD;\"> plt</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">subplots</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">,</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #F78C6C;\">1</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">276</span><span style=\"color: #A6ACCD;\">    ax</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">plot</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">records</span><span style=\"color: #89DDFF;\">[</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">reward</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">])</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">277</span><span style=\"color: #A6ACCD;\">    ax</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">set_xlabel</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Iteration</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">278</span><span style=\"color: #A6ACCD;\">    ax</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">set_ylabel</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">Reward</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">279</span><span style=\"color: #A6ACCD;\">    plt</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">show</span><span style=\"color: #89DDFF;\">()</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">280</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">281</span><span style=\"color: #A6ACCD;\">    torch</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">save</span><span style=\"color: #89DDFF;\">(</span><span style=\"color: #82AAFF;\">agent</span><span style=\"color: #89DDFF;\">.</span><span style=\"color: #82AAFF;\">state_dict</span><span style=\"color: #89DDFF;\">(),</span><span style=\"color: #82AAFF;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">models/wingedcone_ppo.pth</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">)</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">282</span>&nbsp;</div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">283</span><span style=\"color: #89DDFF;\">if</span><span style=\"color: #A6ACCD;\"> __name__ </span><span style=\"color: #89DDFF;\">==</span><span style=\"color: #A6ACCD;\"> </span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #C3E88D;\">__main__</span><span style=\"color: #89DDFF;\">&quot;</span><span style=\"color: #89DDFF;\">:</span></div><div class='line'><span style=\"color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">284</span><span style=\"color: #A6ACCD;\">    </span><span style=\"color: #82AAFF;\">main</span><span style=\"color: #89DDFF;\">()</span></div>","classes":"torchlight","styles":"background-color: #292D3E; --theme-selection-background: #00000080;"}}
