{"expires":1743605056.828,"value":{"highlighted":"<!-- Syntax highlighted by torchlight.dev --><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 1</span><span style=\"color: #0991B6;\">class</span><span style=\"color: #002339;\"> </span><span style=\"color: #0444AC;\">MinimalEnv</span><span style=\"color: #002339;\"> : </span><span style=\"color: #0991B6;\">public</span><span style=\"color: #002339;\"> </span><span style=\"color: #0444AC;\">BaseEnv</span><span style=\"color: #002339;\"> {</span><span style=\"color: #357B42;\"> // 继承自 BaseEnv</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 2</span><span style=\"color: #0991B6;\">public:</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 3</span><span style=\"color: #002339;\">    </span><span style=\"color: #B1108E;\">MinimalEnv</span><span style=\"color: #002339;\">() : </span><span style=\"color: #B1108E;\">cpp_state</span><span style=\"color: #002339;\">(</span><span style=\"color: #174781;\">0</span><span style=\"color: #002339;\">) {}</span><span style=\"color: #357B42;\"> // 初始化 cpp_state 为 0</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 4</span>&nbsp;</div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 5</span><span style=\"color: #002339;\">    </span><span style=\"color: #B1108E;\">~MinimalEnv</span><span style=\"color: #002339;\">() {}</span><span style=\"color: #357B42;\"> // 析构函数</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 6</span>&nbsp;</div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 7</span><span style=\"color: #002339;\">    py::</span><span style=\"color: #0444AC;\">object</span><span style=\"color: #002339;\"> </span><span style=\"color: #B1108E;\">reset</span><span style=\"color: #002339;\">() override</span><span style=\"color: #357B42;\"> // 重写 BaseEnv 中定义的 reset 方法</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 8</span><span style=\"color: #002339;\">    {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 9</span><span style=\"color: #002339;\">        py::dict result;</span><span style=\"color: #357B42;\"> // 创建一个字典来存储要返回的结果</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">10</span><span style=\"color: #002339;\">        cpp_state </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> </span><span style=\"color: #174781;\">0</span><span style=\"color: #002339;\">;</span><span style=\"color: #357B42;\"> // 将 cpp_state 重置为 0</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">11</span><span style=\"color: #002339;\">        </span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">cpp_state</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">] </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> cpp_state;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">12</span><span style=\"color: #002339;\">        </span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">info</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">] </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> </span><span style=\"color: #D86DB6;\">&quot;&quot;</span><span style=\"color: #002339;\">;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">13</span><span style=\"color: #002339;\">        </span><span style=\"color: #0991B6;\">return</span><span style=\"color: #002339;\"> result;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">14</span><span style=\"color: #002339;\">    }</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">15</span>&nbsp;</div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">16</span><span style=\"color: #002339;\">    py::</span><span style=\"color: #0444AC;\">object</span><span style=\"color: #002339;\"> </span><span style=\"color: #B1108E;\">step</span><span style=\"color: #002339;\">(</span><span style=\"color: #0991B6;\">const</span><span style=\"color: #002339;\"> py::</span><span style=\"color: #0444AC;\">object</span><span style=\"color: #0991B6;\">&amp;</span><span style=\"color: #002339;\"> </span><span style=\"color: #B1108E;\">action</span><span style=\"color: #002339;\">) override</span><span style=\"color: #357B42;\"> // step 方法从 Python 端接收动作</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">17</span><span style=\"color: #002339;\">    {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">18</span><span style=\"color: #357B42;\">        // 在每一步中，环境将 action[&quot;value&quot;] 的值加到其 cpp_state 上</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">19</span><span style=\"color: #002339;\">        py::dict result;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">20</span><span style=\"color: #002339;\">        </span><span style=\"color: #0991B6;\">if</span><span style=\"color: #002339;\"> (</span><span style=\"color: #2F86D2;\">action</span><span style=\"color: #002339;\">.</span><span style=\"color: #B1108E;\">contains</span><span style=\"color: #002339;\">(</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">value</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">))</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">21</span><span style=\"color: #002339;\">        {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">22</span><span style=\"color: #002339;\">            </span><span style=\"color: #0991B6;\">try</span><span style=\"color: #002339;\"> {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">23</span><span style=\"color: #002339;\">                </span><span style=\"color: #0991B6;\">int</span><span style=\"color: #002339;\"> value </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> </span><span style=\"color: #2F86D2;\">action</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">value</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">].</span><span style=\"color: #7FDBCA;\">cast</span><span style=\"color: #7B30D0;\">&lt;</span><span style=\"color: #0991B6;\">int</span><span style=\"color: #7B30D0;\">&gt;</span><span style=\"color: #002339;\">();</span><span style=\"color: #357B42;\"> // 将 action[&quot;value&quot;] 的值转换为整数</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">24</span><span style=\"color: #002339;\">                cpp_state </span><span style=\"color: #7B30D0;\">+=</span><span style=\"color: #002339;\"> value;</span><span style=\"color: #357B42;\"> // 将该值加到 cpp_state 上</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">25</span><span style=\"color: #002339;\">            } </span><span style=\"color: #0991B6;\">catch</span><span style=\"color: #002339;\"> (</span><span style=\"color: #0991B6;\">const</span><span style=\"color: #002339;\"> std::exception </span><span style=\"color: #7B30D0;\">&amp;</span><span style=\"color: #002339;\">e) {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">26</span><span style=\"color: #002339;\">                </span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">info</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">] </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> std::</span><span style=\"color: #B1108E;\">string</span><span style=\"color: #002339;\">(</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">failed to convert value to int: </span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">) </span><span style=\"color: #7B30D0;\">+</span><span style=\"color: #002339;\"> </span><span style=\"color: #2F86D2;\">e</span><span style=\"color: #002339;\">.</span><span style=\"color: #B1108E;\">what</span><span style=\"color: #002339;\">();</span><span style=\"color: #357B42;\"> // 如果该值不是整数，在结果中添加错误信息</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">27</span><span style=\"color: #002339;\">            }</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">28</span><span style=\"color: #002339;\">        }</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">29</span><span style=\"color: #002339;\">        </span><span style=\"color: #0991B6;\">else</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">30</span><span style=\"color: #002339;\">        {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">31</span><span style=\"color: #002339;\">            </span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">info</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">] </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> </span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">error: action must contain &#39;value&#39;</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">32</span><span style=\"color: #002339;\">        }</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">33</span>&nbsp;</div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">34</span><span style=\"color: #002339;\">        </span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">cpp_state</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">] </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> cpp_state;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">35</span><span style=\"color: #002339;\">        </span><span style=\"color: #0991B6;\">if</span><span style=\"color: #002339;\"> (</span><span style=\"color: #7B30D0;\">!</span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">.</span><span style=\"color: #B1108E;\">contains</span><span style=\"color: #002339;\">(</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">info</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">))</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">36</span><span style=\"color: #002339;\">        {</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">37</span><span style=\"color: #357B42;\">            // 如果结果中没有 info 键，添加一个空字符串，以避免 key error</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">38</span><span style=\"color: #002339;\">            </span><span style=\"color: #2F86D2;\">result</span><span style=\"color: #002339;\">[</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #A44185;\">info</span><span style=\"color: #D86DB6;\">&quot;</span><span style=\"color: #002339;\">] </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> </span><span style=\"color: #D86DB6;\">&quot;&quot;</span><span style=\"color: #002339;\">;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">39</span><span style=\"color: #002339;\">        }</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">40</span><span style=\"color: #002339;\">        </span><span style=\"color: #0991B6;\">return</span><span style=\"color: #002339;\"> result;</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">41</span><span style=\"color: #002339;\">    }</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">42</span>&nbsp;</div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">43</span><span style=\"color: #0991B6;\">private:</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">44</span><span style=\"color: #002339;\">    </span><span style=\"color: #0991B6;\">int</span><span style=\"color: #002339;\"> cpp_state </span><span style=\"color: #7B30D0;\">=</span><span style=\"color: #002339;\"> </span><span style=\"color: #174781;\">0</span><span style=\"color: #002339;\">;</span><span style=\"color: #357B42;\"> // 私有成员变量，用于存储环境的状态</span></div><div class='line'><span style=\"color:#2f86d2; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">45</span><span style=\"color: #002339;\">};</span></div>","classes":"torchlight","styles":"background-color: #FFFFFF; --theme-selection-background: #4373c2;"}}
