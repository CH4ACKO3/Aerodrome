{"expires":1743604765.105,"value":{"highlighted":"<!-- Syntax highlighted by torchlight.dev --><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  1</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> random</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  2</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> numpy </span><span style=\"color: #D73A49;\">as</span><span style=\"color: #24292E;\"> np</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  3</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> argparse</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  4</span><span style=\"color: #D73A49;\">from</span><span style=\"color: #24292E;\"> copy </span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> deepcopy</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  5</span><span style=\"color: #D73A49;\">from</span><span style=\"color: #24292E;\"> tqdm </span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> tqdm</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  6</span><span style=\"color: #D73A49;\">from</span><span style=\"color: #24292E;\"> matplotlib </span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> pyplot </span><span style=\"color: #D73A49;\">as</span><span style=\"color: #24292E;\"> plt</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  7</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  8</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> torch</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">  9</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> torch.nn </span><span style=\"color: #D73A49;\">as</span><span style=\"color: #24292E;\"> nn</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 10</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> torch.nn.functional </span><span style=\"color: #D73A49;\">as</span><span style=\"color: #24292E;\"> F</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 11</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> torch.optim </span><span style=\"color: #D73A49;\">as</span><span style=\"color: #24292E;\"> optim</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 12</span><span style=\"color: #D73A49;\">from</span><span style=\"color: #24292E;\"> torch.optim.lr_scheduler </span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> CosineAnnealingLR</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 13</span><span style=\"color: #D73A49;\">import</span><span style=\"color: #24292E;\"> aerodrome</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 14</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 15</span><span style=\"color: #D73A49;\">class</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">ReplayBuffer</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 16</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">__init__</span><span style=\"color: #24292E;\">(self, buffer_size: </span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 17</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.buffer_size </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> buffer_size</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 18</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.full </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">False</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 19</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 20</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.zeros((buffer_size, </span><span style=\"color: #005CC5;\">4</span><span style=\"color: #24292E;\">), </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 21</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.act </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.zeros((buffer_size, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">), </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 22</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.reward </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.zeros((buffer_size, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">), </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 23</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.next_obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.zeros((buffer_size, </span><span style=\"color: #005CC5;\">4</span><span style=\"color: #24292E;\">), </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 24</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.terminated </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.zeros((buffer_size, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">), </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 25</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.truncated </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.zeros((buffer_size, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">), </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 26</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 27</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">push</span><span style=\"color: #24292E;\">(self, obs, act, reward, next_obs, terminated, truncated):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 28</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.obs[</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> obs</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 29</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.act[</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> act</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 30</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.reward[</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> reward</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 31</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.next_obs[</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> next_obs</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 32</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.terminated[</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> terminated</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 33</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.truncated[</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> truncated</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 34</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> (</span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer </span><span style=\"color: #D73A49;\">+</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">) </span><span style=\"color: #D73A49;\">%</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.buffer_size</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 35</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> </span><span style=\"color: #D73A49;\">not</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.full </span><span style=\"color: #D73A49;\">and</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer </span><span style=\"color: #D73A49;\">==</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 36</span><span style=\"color: #24292E;\">            </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.full </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">True</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 37</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 38</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">sample</span><span style=\"color: #24292E;\">(self, batch_size: </span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 39</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.full:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 40</span><span style=\"color: #24292E;\">            indices </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.random.randint(</span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">, </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.buffer_size, </span><span style=\"color: #E36209;\">size</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">batch_size)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 41</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">else</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 42</span><span style=\"color: #24292E;\">            indices </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.random.randint(</span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">, </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.pointer, </span><span style=\"color: #E36209;\">size</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">batch_size)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 43</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 44</span><span style=\"color: #24292E;\">        data </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> {</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 45</span><span style=\"color: #24292E;\">            </span><span style=\"color: #032F62;\">&quot;obs&quot;</span><span style=\"color: #24292E;\">: </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.obs[indices],</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 46</span><span style=\"color: #24292E;\">            </span><span style=\"color: #032F62;\">&quot;act&quot;</span><span style=\"color: #24292E;\">: </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.act[indices],</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 47</span><span style=\"color: #24292E;\">            </span><span style=\"color: #032F62;\">&quot;reward&quot;</span><span style=\"color: #24292E;\">: </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.reward[indices],</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 48</span><span style=\"color: #24292E;\">            </span><span style=\"color: #032F62;\">&quot;next_obs&quot;</span><span style=\"color: #24292E;\">: </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.next_obs[indices],</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 49</span><span style=\"color: #24292E;\">            </span><span style=\"color: #032F62;\">&quot;terminated&quot;</span><span style=\"color: #24292E;\">: </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.terminated[indices],</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 50</span><span style=\"color: #24292E;\">            </span><span style=\"color: #032F62;\">&quot;truncated&quot;</span><span style=\"color: #24292E;\">: </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.truncated[indices]</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 51</span><span style=\"color: #24292E;\">        }</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 52</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">return</span><span style=\"color: #24292E;\"> data</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 53</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 54</span><span style=\"color: #D73A49;\">class</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">QNetwork</span><span style=\"color: #24292E;\">(</span><span style=\"color: #6F42C1;\">nn</span><span style=\"color: #24292E;\">.</span><span style=\"color: #6F42C1;\">Module</span><span style=\"color: #24292E;\">):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 55</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">__init__</span><span style=\"color: #24292E;\">(self):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 56</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">super</span><span style=\"color: #24292E;\">().</span><span style=\"color: #005CC5;\">__init__</span><span style=\"color: #24292E;\">()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 57</span><span style=\"color: #24292E;\">        </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.network </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> nn.Sequential(</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 58</span><span style=\"color: #24292E;\">            nn.Linear(</span><span style=\"color: #005CC5;\">4</span><span style=\"color: #24292E;\">, </span><span style=\"color: #005CC5;\">256</span><span style=\"color: #24292E;\">),</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 59</span><span style=\"color: #24292E;\">            nn.ReLU(),</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 60</span><span style=\"color: #24292E;\">            nn.Linear(</span><span style=\"color: #005CC5;\">256</span><span style=\"color: #24292E;\">, </span><span style=\"color: #005CC5;\">256</span><span style=\"color: #24292E;\">),</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 61</span><span style=\"color: #24292E;\">            nn.ReLU(),</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 62</span><span style=\"color: #24292E;\">            nn.Linear(</span><span style=\"color: #005CC5;\">256</span><span style=\"color: #24292E;\">, </span><span style=\"color: #005CC5;\">2</span><span style=\"color: #24292E;\">),</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 63</span><span style=\"color: #24292E;\">        )</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 64</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 65</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">forward</span><span style=\"color: #24292E;\">(self, x):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 66</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">return</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">self</span><span style=\"color: #24292E;\">.network(x)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 67</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 68</span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">linear_schedule</span><span style=\"color: #24292E;\">(start_e, end_e, duration, t):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 69</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">return</span><span style=\"color: #24292E;\"> start_e </span><span style=\"color: #D73A49;\">+</span><span style=\"color: #24292E;\"> (end_e </span><span style=\"color: #D73A49;\">-</span><span style=\"color: #24292E;\"> start_e) </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">min</span><span style=\"color: #24292E;\">(t </span><span style=\"color: #D73A49;\">/</span><span style=\"color: #24292E;\"> duration, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 70</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 71</span><span style=\"color: #D73A49;\">def</span><span style=\"color: #24292E;\"> </span><span style=\"color: #6F42C1;\">main</span><span style=\"color: #24292E;\">():</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 72</span><span style=\"color: #24292E;\">    parser </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> argparse.ArgumentParser()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 73</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--seed&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 74</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;random seed of the experiment&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 75</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--batch_size&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">2048</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 76</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;the batch size of sample from the reply memory&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 77</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--gamma&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">float</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">0.99</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 78</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;discount factor&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 79</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--tau&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">float</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">0.1</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 80</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;the target network update rate&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 81</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--target_network_frequency&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">1_000</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 82</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;the frequency of target network update&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 83</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--start_e&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">float</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">1.0</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 84</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;starting epsilon&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 85</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--end_e&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">float</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">0.01</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 86</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;ending epsilon&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 87</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--exploration_fraction&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">float</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">0.5</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 88</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;the timesteps it takes to update the target network&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 89</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--learning_rate&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">float</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">1e-3</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 90</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;learning rate&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 91</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--total_timesteps&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">1_000_000</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 92</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;total number of timesteps&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 93</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--buffer_size&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">100_000</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 94</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;buffer size&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 95</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--learning_starts&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">10_000</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 96</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;timestep to start learning&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 97</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--train_frequency&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">int</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">10</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 98</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;the frequency of training&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\"> 99</span><span style=\"color: #24292E;\">    parser.add_argument(</span><span style=\"color: #032F62;\">&quot;--device&quot;</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">type</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">str</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">default</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;cuda&quot;</span><span style=\"color: #24292E;\"> </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> torch.cuda.is_available() </span><span style=\"color: #D73A49;\">else</span><span style=\"color: #24292E;\"> </span><span style=\"color: #032F62;\">&quot;cpu&quot;</span><span style=\"color: #24292E;\">,</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">100</span><span style=\"color: #24292E;\">                        </span><span style=\"color: #E36209;\">help</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;Device to run the experiment on&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">101</span><span style=\"color: #24292E;\">    args </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> parser.parse_args()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">102</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">103</span><span style=\"color: #24292E;\">    random.seed(args.seed)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">104</span><span style=\"color: #24292E;\">    np.random.seed(args.seed)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">105</span><span style=\"color: #24292E;\">    torch.manual_seed(args.seed)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">106</span><span style=\"color: #24292E;\">    torch.backends.cudnn.deterministic </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">True</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">107</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">108</span><span style=\"color: #24292E;\">    device </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.device(args.device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">109</span><span style=\"color: #24292E;\">    </span><span style=\"color: #005CC5;\">print</span><span style=\"color: #24292E;\">(</span><span style=\"color: #D73A49;\">f</span><span style=\"color: #032F62;\">&quot;Using device: </span><span style=\"color: #005CC5;\">{</span><span style=\"color: #24292E;\">device</span><span style=\"color: #005CC5;\">}</span><span style=\"color: #032F62;\">&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">110</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">111</span><span style=\"color: #24292E;\">    q_network </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> QNetwork().to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">112</span><span style=\"color: #24292E;\">    target_network </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> QNetwork().to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">113</span><span style=\"color: #24292E;\">    target_network.load_state_dict(q_network.state_dict())</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">114</span><span style=\"color: #24292E;\">    target_network.eval()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">115</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">116</span><span style=\"color: #24292E;\">    optimizer </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> optim.Adam(q_network.parameters(), </span><span style=\"color: #E36209;\">lr</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">args.learning_rate)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">117</span><span style=\"color: #24292E;\">    cos_annealing_scheduler </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> CosineAnnealingLR(optimizer, </span><span style=\"color: #E36209;\">T_max</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">args.total_timesteps, </span><span style=\"color: #E36209;\">eta_min</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">args.learning_rate </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0.01</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">118</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">119</span><span style=\"color: #24292E;\">    replay_buffer </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> ReplayBuffer(args.buffer_size)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">120</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">121</span><span style=\"color: #24292E;\">    env </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> aerodrome.make(</span><span style=\"color: #032F62;\">&quot;cartpole-v0&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">122</span><span style=\"color: #24292E;\">    obs, info </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> env.reset()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">123</span><span style=\"color: #24292E;\">    obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.array(obs, </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">124</span><span style=\"color: #24292E;\">    </span><span style=\"color: #005CC5;\">print</span><span style=\"color: #24292E;\">(obs, info)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">125</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">126</span><span style=\"color: #24292E;\">    episode_length </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> []</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">127</span><span style=\"color: #24292E;\">    current_step </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">128</span><span style=\"color: #24292E;\">    </span><span style=\"color: #D73A49;\">for</span><span style=\"color: #24292E;\"> step </span><span style=\"color: #D73A49;\">in</span><span style=\"color: #24292E;\"> tqdm(</span><span style=\"color: #005CC5;\">range</span><span style=\"color: #24292E;\">(args.total_timesteps)):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">129</span><span style=\"color: #24292E;\">        current_step </span><span style=\"color: #D73A49;\">+=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">1</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">130</span><span style=\"color: #24292E;\">        epsilon </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> linear_schedule(args.start_e, args.end_e, args.exploration_fraction </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> args.total_timesteps, step)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">131</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> random.random() </span><span style=\"color: #D73A49;\">&lt;</span><span style=\"color: #24292E;\"> epsilon:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">132</span><span style=\"color: #24292E;\">            action </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> random.randint(</span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">133</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">else</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">134</span><span style=\"color: #24292E;\">            </span><span style=\"color: #D73A49;\">with</span><span style=\"color: #24292E;\"> torch.no_grad():</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">135</span><span style=\"color: #24292E;\">                q_values </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> q_network(torch.from_numpy(obs).unsqueeze(</span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">).to(device))</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">136</span><span style=\"color: #24292E;\">                action </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.argmax(q_values, </span><span style=\"color: #E36209;\">dim</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">).cpu().numpy().item()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">137</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">138</span><span style=\"color: #24292E;\">        next_obs, reward, terminated, truncated, info </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> env.step(action)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">139</span><span style=\"color: #24292E;\">        next_obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.array(next_obs, </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">140</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">141</span><span style=\"color: #24292E;\">        real_next_obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> deepcopy(next_obs)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">142</span><span style=\"color: #24292E;\">        replay_buffer.push(obs, action, reward, real_next_obs, terminated, truncated)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">143</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">144</span><span style=\"color: #24292E;\">        obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> next_obs</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">145</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">146</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> step </span><span style=\"color: #D73A49;\">&gt;</span><span style=\"color: #24292E;\"> args.learning_starts:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">147</span><span style=\"color: #24292E;\">            </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> step </span><span style=\"color: #D73A49;\">%</span><span style=\"color: #24292E;\"> args.train_frequency </span><span style=\"color: #D73A49;\">==</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">148</span><span style=\"color: #24292E;\">                batch </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> replay_buffer.sample(args.batch_size)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">149</span><span style=\"color: #24292E;\">                batch[</span><span style=\"color: #032F62;\">&quot;obs&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.from_numpy(batch[</span><span style=\"color: #032F62;\">&quot;obs&quot;</span><span style=\"color: #24292E;\">]).to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">150</span><span style=\"color: #24292E;\">                batch[</span><span style=\"color: #032F62;\">&quot;act&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.from_numpy(batch[</span><span style=\"color: #032F62;\">&quot;act&quot;</span><span style=\"color: #24292E;\">]).to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">151</span><span style=\"color: #24292E;\">                batch[</span><span style=\"color: #032F62;\">&quot;reward&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.from_numpy(batch[</span><span style=\"color: #032F62;\">&quot;reward&quot;</span><span style=\"color: #24292E;\">]).to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">152</span><span style=\"color: #24292E;\">                batch[</span><span style=\"color: #032F62;\">&quot;next_obs&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.from_numpy(batch[</span><span style=\"color: #032F62;\">&quot;next_obs&quot;</span><span style=\"color: #24292E;\">]).to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">153</span><span style=\"color: #24292E;\">                batch[</span><span style=\"color: #032F62;\">&quot;terminated&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.from_numpy(batch[</span><span style=\"color: #032F62;\">&quot;terminated&quot;</span><span style=\"color: #24292E;\">]).to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">154</span><span style=\"color: #24292E;\">                batch[</span><span style=\"color: #032F62;\">&quot;truncated&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> torch.from_numpy(batch[</span><span style=\"color: #032F62;\">&quot;truncated&quot;</span><span style=\"color: #24292E;\">]).to(device)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">155</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">156</span><span style=\"color: #24292E;\">                </span><span style=\"color: #D73A49;\">with</span><span style=\"color: #24292E;\"> torch.no_grad():</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">157</span><span style=\"color: #24292E;\">                    target_max, _ </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> target_network(batch[</span><span style=\"color: #032F62;\">&quot;next_obs&quot;</span><span style=\"color: #24292E;\">]).max(</span><span style=\"color: #E36209;\">dim</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">keepdim</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">True</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">158</span><span style=\"color: #24292E;\">                    td_target </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> batch[</span><span style=\"color: #032F62;\">&quot;reward&quot;</span><span style=\"color: #24292E;\">] </span><span style=\"color: #D73A49;\">+</span><span style=\"color: #24292E;\"> args.gamma </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> (</span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\"> </span><span style=\"color: #D73A49;\">-</span><span style=\"color: #24292E;\"> batch[</span><span style=\"color: #032F62;\">&quot;terminated&quot;</span><span style=\"color: #24292E;\">]) </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> target_max </span><span style=\"color: #D73A49;\">-</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">10.0</span><span style=\"color: #24292E;\"> </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> batch[</span><span style=\"color: #032F62;\">&quot;terminated&quot;</span><span style=\"color: #24292E;\">]</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">159</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">160</span><span style=\"color: #24292E;\">                old_val </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> q_network(batch[</span><span style=\"color: #032F62;\">&quot;obs&quot;</span><span style=\"color: #24292E;\">])</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">161</span><span style=\"color: #24292E;\">                old_val </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> old_val.gather(</span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">, batch[</span><span style=\"color: #032F62;\">&quot;act&quot;</span><span style=\"color: #24292E;\">].long())</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">162</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">163</span><span style=\"color: #24292E;\">                loss </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> F.mse_loss(td_target, old_val)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">164</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">165</span><span style=\"color: #24292E;\">                optimizer.zero_grad()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">166</span><span style=\"color: #24292E;\">                loss.backward()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">167</span><span style=\"color: #24292E;\">                optimizer.step()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">168</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">169</span><span style=\"color: #24292E;\">            </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> step </span><span style=\"color: #D73A49;\">%</span><span style=\"color: #24292E;\"> args.target_network_frequency </span><span style=\"color: #D73A49;\">==</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">170</span><span style=\"color: #24292E;\">                </span><span style=\"color: #D73A49;\">for</span><span style=\"color: #24292E;\"> target_param, param </span><span style=\"color: #D73A49;\">in</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">zip</span><span style=\"color: #24292E;\">(target_network.parameters(), q_network.parameters()):</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">171</span><span style=\"color: #24292E;\">                    target_param.data.copy_(args.tau </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> param.data </span><span style=\"color: #D73A49;\">+</span><span style=\"color: #24292E;\"> (</span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\"> </span><span style=\"color: #D73A49;\">-</span><span style=\"color: #24292E;\"> args.tau) </span><span style=\"color: #D73A49;\">*</span><span style=\"color: #24292E;\"> target_param.data)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">172</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">173</span><span style=\"color: #24292E;\">        cos_annealing_scheduler.step()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">174</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">175</span><span style=\"color: #24292E;\">        </span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> terminated </span><span style=\"color: #D73A49;\">or</span><span style=\"color: #24292E;\"> truncated:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">176</span><span style=\"color: #24292E;\">            obs, info </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> env.reset()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">177</span><span style=\"color: #24292E;\">            obs </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.array(obs, </span><span style=\"color: #E36209;\">dtype</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\">np.float32)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">178</span><span style=\"color: #24292E;\">            episode_length.append((step, current_step))</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">179</span><span style=\"color: #24292E;\">            current_step </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">0</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">180</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">181</span><span style=\"color: #24292E;\">    episode_length </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.array(episode_length)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">182</span><span style=\"color: #24292E;\">    fig, ax </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> plt.subplots()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">183</span><span style=\"color: #24292E;\">    ax.plot(episode_length[:, </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">], episode_length[:, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">], </span><span style=\"color: #E36209;\">alpha</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #005CC5;\">0.5</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">c</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;skyblue&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">184</span><span style=\"color: #24292E;\">    moving_average </span><span style=\"color: #D73A49;\">=</span><span style=\"color: #24292E;\"> np.convolve(episode_length[:, </span><span style=\"color: #005CC5;\">1</span><span style=\"color: #24292E;\">], np.ones(</span><span style=\"color: #005CC5;\">100</span><span style=\"color: #24292E;\">) </span><span style=\"color: #D73A49;\">/</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">100</span><span style=\"color: #24292E;\">, </span><span style=\"color: #E36209;\">mode</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&#39;valid&#39;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">185</span><span style=\"color: #24292E;\">    ax.plot(episode_length[</span><span style=\"color: #005CC5;\">99</span><span style=\"color: #24292E;\">:, </span><span style=\"color: #005CC5;\">0</span><span style=\"color: #24292E;\">], moving_average, </span><span style=\"color: #E36209;\">c</span><span style=\"color: #D73A49;\">=</span><span style=\"color: #032F62;\">&quot;royalblue&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">186</span><span style=\"color: #24292E;\">    ax.set_xlabel(</span><span style=\"color: #032F62;\">&quot;steps&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">187</span><span style=\"color: #24292E;\">    ax.set_ylabel(</span><span style=\"color: #032F62;\">&quot;cumulative reward&quot;</span><span style=\"color: #24292E;\">)</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">188</span><span style=\"color: #24292E;\">    plt.show()</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">189</span>&nbsp;</div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">190</span><span style=\"color: #D73A49;\">if</span><span style=\"color: #24292E;\"> </span><span style=\"color: #005CC5;\">__name__</span><span style=\"color: #24292E;\"> </span><span style=\"color: #D73A49;\">==</span><span style=\"color: #24292E;\"> </span><span style=\"color: #032F62;\">&quot;__main__&quot;</span><span style=\"color: #24292E;\">:</span></div><div class='line'><span style=\"color:#1b1f234d; text-align: right; -webkit-user-select: none; user-select: none;\" class=\"line-number\">191</span><span style=\"color: #24292E;\">    main()</span></div>","classes":"torchlight","styles":"background-color: #fff; --theme-selection-background: #e2e5e9;"}}
